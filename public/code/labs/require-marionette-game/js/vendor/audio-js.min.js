(function(e){"use strict";var t=function(t){var n=new XMLHttpRequest;n.addEventListener("load",function(){t.success(n.response)},false);try{n.open("GET",t.file,true);n.responseType="arraybuffer";n.send()}catch(r){e.console.log(r)}};var n=function(){return{register:function(e){this.callback=e.callback;this.context=e.context},execute:function(){if(this.callback){this.callback.call(this.context)}}}};var r=function(e){if(!e){throw"You need to pass a value as parameter!"}this._cachedVariabes(e);this._load()};r.prototype={_validateFormat:function(){var e=/\.(mp3|opus|ogg|wav|m4a|weba)$/;var t=e.test(this.file);if(!t){throw"The format of the audio file is invalid!"}},_createInstance:function(){var t=e.AudioContext||e.webkitAudioContext||null;var n=t;if(!n){throw"Your browser does not support API AudioContext!"}this.audioContext=new t},_cachedVariabes:function(e){this._createInstance();var t=typeof e==="string";if(t){this.file=e}else{this.file=e.file;this.autoPlay=e.autoPlay;this.loop=e.loop||false;this.volume=e.volume||1}this._validateFormat();this.callbackManager=new n},_load:function(){var e=this;t({file:this.file,success:function(t){e._decodeAudioData.call(e,t);Registry.musicLoaded=true;updateLoader()}})},_decodeAudioData:function(e){var t=this;var n=this.audioContext;n.decodeAudioData(e,function(e){t.source=n.createBufferSource();t.source.buffer=e;t.source.connect(n.destination);t.source.gain.value=t.volume;t.source.loop=t.loop;t.buffer=e;if(t.autoPlay||t.shouldPlay){t.callbackManager.register({callback:t._play,context:t});t.callbackManager.execute()}},function(){throw"Decoding the audio buffer failed!"})},_play:function(){this.source.start(0);this.isStarted=true},play:function(){this.callbackManager.register({callback:this._play,context:this});if(this.buffer&&this.shouldPlay){this.source=this.audioContext.createBufferSource();this.source.buffer=this.buffer;this.source.connect(this.audioContext.destination);this.source.gain.value=this.volume;this.source.loop=this.loop;this.source.start(0);this.isStarted=true}this.shouldPlay=true},stop:function(){if(this.isStarted){this.source.stop(0);this.isStarted=false}}};e.audioJS=function(e){return new r(e)}})(this)